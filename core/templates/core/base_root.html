<!DOCTYPE html>
<html lang="en">
  {% load static %}
  <head>
    <meta charset="UTF-8" />
    <title>{% block title %}My Django App{% endblock %}</title>

    <!-- âœ… Bootstrap 5 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- âœ… Bootstrap Table (replaces DataTables) -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/bootstrap-table@1.22.3/dist/bootstrap-table.min.css"
    />

    <!-- âœ… Font Awesome (optional, keep if you use icons) -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
      referrerpolicy="no-referrer"
    />

    <!-- âœ… Your custom styles -->
    <link rel="stylesheet" href="{% static 'custom.css' %}" />
    <link rel="stylesheet" href="{% static 'css/tables.css' %}" />
    <script src="{% static 'core/js/tables.js' %}"></script>

    <style>
      .navbar-brand img { height: 40px; }
      .user-dropdown:hover .dropdown-menu { display: block; }
    </style>

    {% block extra_head %}{% endblock %}
  </head>
  <body>
    <!-- ðŸ”· Top Nav Bar -->
    <nav class="navbar navbar-expand-lg {% block navbar_class %}bg-primary{% endblock %} navbar-dark">
      <div class="container-fluid">
        <!-- ðŸ‘¤ Left: App logo -->
        <div class="d-flex align-items-center">
          <a class="navbar-brand ms-auto" href="/">
            <img src="{% static 'core/img/a.png' %}" alt="Logo" />
          </a>
        </div>

        <!-- ðŸ“‹ Center: App-specific nav links -->
        <div class="collapse navbar-collapse justify-content-center">
          {% block app_nav %}{% endblock %}
        </div>

        <!-- ðŸ§‘ Right: User dropdown -->
        <div class="d-flex align-items-center">
          <div class="dropdown user-dropdown">
            <a
              class="nav-link dropdown-toggle text-white"
              href="#"
              id="userDropdown"
              role="button"
              data-bs-toggle="dropdown"
            >
              <i class="fas fa-user-circle"></i> {{ user.username }}
            </a>
            <ul class="dropdown-menu dropdown-menu-start" aria-labelledby="userDropdown">
              {% if user.is_authenticated %}
              <li>
                <form method="post" action="{% url 'core:full_logout' %}" class="d-inline">
                  {% csrf_token %}
                  <button type="submit" class="dropdown-item">Logout (everywhere) EXCEPT HERE</button>
                </form>
              </li>
              {% endif %}
            </ul>
          </div>
        </div>
      </div>
    </nav>

    <!-- ðŸ“„ Main Page Content -->
    <div class="container mt-4">
      {% block content %}{% endblock %}
    </div>

    <!-- âœ… JS Dependencies (order matters) -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- âœ… Bootstrap Table -->
    <script src="https://unpkg.com/bootstrap-table@1.22.3/dist/bootstrap-table.min.js"></script>

    <!-- (Optional) Global defaults for all bootstrap-table instances -->
    <script>
      (function () {
        if (!$.fn.bootstrapTable) return;
        $.extend($.fn.bootstrapTable.defaults, {
          pageSize: 50,
          pageList: [25, 50, 100, 'All'],
          pagination: true,
          search: true,
          sortable: true,
          // Uncomment any of these if you want them site-wide:
          // showColumns: true,        // column show/hide dropdown
          // showRefresh: true,        // refresh button
          // buttonsClass: 'primary',  // toolbar button color
          // iconsPrefix: 'fa',        // use Font Awesome icons
        });
      })();
    </script>

    {% block extra_js %}{% endblock %}
  </body>
</html>
